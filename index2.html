<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ä¸­æ–‡å¸¸ç”¨è¯­ 100 å¥ï½œç‚¹è¯»è¯¾ä»¶</title>

<style>
:root{
  --bg:#0b1220; --card:#0f1a30; --muted:#94a3b8; --text:#e5e7eb;
  --accent:#22c55e; --accent2:#60a5fa; --danger:#fb7185;
  --border:rgba(148,163,184,.18);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans Thai","Noto Sans",sans-serif;
  background:linear-gradient(180deg,#050915 0%,#0b1220 100%);
  color:var(--text)
}
header{
  position:sticky;top:0;z-index:50;
  background:rgba(11,18,32,.85);
  backdrop-filter:blur(10px);
  border-bottom:1px solid var(--border)
}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
.top{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
h1{font-size:18px;margin:0}
.pill{padding:6px 10px;border:1px solid var(--border);border-radius:999px;color:var(--muted);font-size:12px}

.grid{display:grid;grid-template-columns:1fr;gap:12px;margin-top:14px}
@media(min-width:900px){.grid{grid-template-columns:380px 1fr}}

.panel{background:rgba(15,26,48,.7);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.panel .hd{padding:12px;border-bottom:1px solid var(--border);display:flex;gap:10px;flex-wrap:wrap}
.panel .bd{padding:12px}

.btn{
  cursor:pointer;border:1px solid var(--border);
  background:#0a1327;color:var(--text);
  padding:9px 12px;border-radius:10px;font-weight:600;font-size:13px
}
.btn.primary{background:linear-gradient(90deg,#16a34a,#22c55e);border:none;color:#04110a}
.btn.secondary{background:linear-gradient(90deg,#2563eb,#60a5fa);border:none;color:#071225}

input{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#081022;color:#fff}

.list{max-height:62vh;overflow:auto}
.item{padding:10px;border-bottom:1px solid var(--border);cursor:pointer}
.item:hover{background:rgba(96,165,250,.08)}
.item.active{background:rgba(34,197,94,.12)}
.th{font-size:16px}
.zh{font-size:13px;color:#c7d2fe;margin-top:4px}

.card{padding:14px;border-radius:14px;background:rgba(15,26,48,.7);border:1px solid var(--border)}
.bigTH{font-size:22px;font-weight:800}
.bigZH{font-size:20px;margin-top:8px}
.bigPY{font-size:14px;color:var(--accent2);margin-top:6px}
.note{font-size:12px;color:var(--muted);line-height:1.5}
</style>
</head>

<body>
<header>
  <div class="wrap top">
    <h1>ä¸­æ–‡å¸¸ç”¨è¯­ 100 å¥<br>
      <span style="font-size:13px;color:#94a3b8">à¸šà¸—à¹€à¸£à¸µà¸¢à¸™à¸ à¸²à¸©à¸²à¸ˆà¸µà¸™ 100 à¸›à¸£à¸°à¹‚à¸¢à¸„</span>
    </h1>
    <span class="pill">ç‚¹å‡»æ’­æ”¾ Â· à¸„à¸¥à¸´à¸à¹€à¸à¸·à¹ˆà¸­à¸Ÿà¸±à¸‡à¹€à¸ªà¸µà¸¢à¸‡</span>
    <span class="pill" id="status">åŠ è½½ä¸­â€¦</span>
  </div>
</header>

<main class="wrap grid">

<!-- å·¦ä¾§ -->
<section class="panel">
  <div class="hd">
    <button class="btn" id="quiz">ğŸ§ å¬éŸ³é€‰å¥</button>
    <button class="btn secondary" id="shuffle">éšæœº</button>
  </div>
  <div class="list" id="list"></div>
</section>

<!-- å³ä¾§ -->
<section class="panel">
  <div class="hd">
    <button class="btn primary" id="play">â–¶ æ’­æ”¾</button>
  </div>
  <div class="bd">
    <div class="card">
      <div class="bigTH" id="bigTH">â€”</div>
      <div class="bigZH" id="bigZH">â€”</div>
      <div class="bigPY" id="bigPY">â€”</div>
    </div>
    <div class="note" style="margin-top:12px">
      æ™®é€šæ¨¡å¼ï¼šç‚¹å¥å­å¬éŸ³<br>
      å¬éŸ³é€‰å¥ï¼šå…ˆå¬ï¼Œå†é€‰æ­£ç¡®å¥
    </div>
  </div>
</section>

</main>

<audio id="audio"></audio>

<script>
const listEl = document.getElementById("list");
const audio = document.getElementById("audio");

let DATA = [];
let activeIdx = 0;
let quizMode = false;
let quizAnswerKey = null;
let quizOptions = [];

function shuffleArray(arr){
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

async function loadCSV(){
  const res = await fetch("phrases.csv");
  const text = await res.text();
  const rows = text.trim().split("\n").slice(1);
  DATA = rows.map(r=>{
    const [th,zh,key]=r.split(",");
    return [th,zh,key];
  });
  renderList();
  select(0);
  document.getElementById("status").textContent=`å·²åŠ è½½ ${DATA.length} æ¡`;
}

function renderList(){
  listEl.innerHTML="";
  const src = quizMode ? quizOptions : DATA;

  src.forEach(item=>{
    const div=document.createElement("div");
    div.className="item";
    div.innerHTML=`<div class="th">${item[0]}</div><div class="zh">${item[1]}</div>`;
    div.onclick=()=>{
      if(quizMode){
        alert(item[2]===quizAnswerKey?"âœ… æ­£ç¡®":"âŒ é”™è¯¯");
        quizMode=false;
        renderList();
        const idx=DATA.findIndex(x=>x[2]===quizAnswerKey);
        select(idx);
      }else{
        select(DATA.findIndex(x=>x[2]===item[2]));
      }
    };
    listEl.appendChild(div);
  });
}

function select(i){
  activeIdx=i;
  const [th,zh,key]=DATA[i];
  document.getElementById("bigTH").textContent=th;
  document.getElementById("bigZH").textContent=zh.split(" ")[0];
  document.getElementById("bigPY").textContent=zh.split(" ").slice(1).join(" ");
}

document.getElementById("play").onclick=()=>{
  audio.src=`audio/${DATA[activeIdx][2]}.mp3`;
  audio.play();
};

document.getElementById("quiz").onclick=()=>{
  quizMode=true;
  const ans=DATA[Math.floor(Math.random()*DATA.length)];
  quizAnswerKey=ans[2];
  const others=shuffleArray(DATA.filter(x=>x[2]!==quizAnswerKey)).slice(0,3);
  quizOptions=shuffleArray([...others,ans]);
  audio.src=`audio/${quizAnswerKey}.mp3`;
  audio.play();
  renderList();
};

document.getElementById("shuffle").onclick=()=>{
  DATA=shuffleArray(DATA);
  renderList();
  select(0);
};

loadCSV();
</script>
</body>
</html>
